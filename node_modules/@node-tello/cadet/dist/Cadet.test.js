"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const sinon_1 = __importDefault(require("sinon"));
const Cadet_1 = require("./Cadet");
describe('Cadet', () => {
    afterEach(() => {
        sinon_1.default.restore();
    });
    /////////////////////////////////////
    //
    // constructor
    describe('constructor', () => {
        it('should set the options passed to it', () => {
            const cadet = new Cadet_1.Cadet({
                localAddress: '0.0.0.0',
                localPort: 1234,
            });
            chai_1.expect(cadet.localAddress).to.equal('0.0.0.0');
            chai_1.expect(cadet.localPort).to.equal(1234);
        });
    });
    /////////////////////////////////////
    //
    // initialise
    describe('initialise', () => {
        let cadet;
        beforeEach(() => {
            cadet = new Cadet_1.Cadet({
                localAddress: '0.0.0.0',
                localPort: 1234
            });
        });
        it('should call _bindSocket', () => {
            // @ts-ignore
            const spy = sinon_1.default.stub(cadet, '_bindSocket');
            cadet.initialise();
            chai_1.expect(spy.callCount).to.eql(1);
        });
        it('should set initialised to true once complete', () => {
            sinon_1.default
                // @ts-ignore
                .stub(cadet, '_bindSocket');
            cadet.initialise();
            chai_1.expect(cadet.initialised).to.eql(true);
        });
        it('should set initialised to false if binding the port fails', () => {
            sinon_1.default
                // @ts-ignore
                .stub(cadet, '_bindSocket')
                .throws(new Error());
            try {
                cadet.initialise();
            }
            catch (e) {
                chai_1.expect(cadet.initialised).to.equal(false);
            }
        });
    });
});
//# sourceMappingURL=Cadet.test.js.map